ДОСТУП К САЙТУ ИЗ ИНТЕРНЕТА (Keenetic Voyager Pro) — максимально "по-человечески"

ТЕБЕ НУЖНО ВЫБРАТЬ 1 ИЗ 2 ВАРИАНТОВ:

ВАРИАНТ 1 (РЕКОМЕНДУЮ): VPN (WireGuard) на Keenetic
- Самый безопасный способ.
- Никаких открытых портов сайта наружу.
- Подключился VPN → и заходишь на сайт как будто дома.

ВАРИАНТ 2: Проброс порта (Port Forwarding)
- Работает только если у тебя у провайдера "белый" (публичный) IP, а не CGNAT.
- Сайт торчит наружу → его будут сканировать боты.
- НУЖНЫ меры защиты (пароль/HTTPS/ограничения).


====================
ВАРИАНТ 1: VPN (WireGuard) — ПРАВИЛЬНО И БЕЗОПАСНО
====================

Шаг 1. Зайди в админку Keenetic
1) Открой браузер на ПК, который в Wi‑Fi/кабеле этого роутера.
2) Введи в адресную строку:
   - http://my.keenetic.net
   или
   - http://192.168.1.1

Шаг 2. Установи компонент WireGuard
1) В админке: "Общие настройки" → "Обновления и компоненты".
2) "Изменить набор компонентов".
3) Найди и включи "WireGuard VPN".
4) Применить/Обновить.

Шаг 3. Создай WireGuard-подключение
1) Появится раздел WireGuard (обычно в "Другие подключения" или "Интернет"/"VPN").
2) Создай "Сервер"/"Подключение" WireGuard.
3) Добавь "Пир" (peer) для телефона/ноута.
4) Скачай/покажи конфиг или QR-код.

Шаг 4. Подключи телефон
1) Установи приложение WireGuard на телефон.
2) Добавь туннель: сканируй QR или импортируй конфиг.
3) Включи туннель.

Шаг 5. Открой сайт через VPN
Когда VPN включен, открывай:
   http://IP_ТВОЕГО_ПК_ДОМА:8000/
Где IP_ТВОЕГО_ПК_ДОМА — это IPv4 из ipconfig (например 192.168.1.50)

Плюс: наружу ничего не открыто.


====================
ВАРИАНТ 2: ПРОБРОС ПОРТА (если прям НАДО)
====================

ПРЕДУПРЕЖДЕНИЕ:
- НЕ советую открывать FastAPI напрямую без защиты.
- Если всё равно делаешь — делай хотя бы:
  1) нестандартный внешний порт (например 18443 вместо 8000)
  2) ограничение источников (если возможно)
  3) пароль/HTTPS через прокси (Caddy/Nginx) — лучше всего

Шаг 1. Закрепи постоянный IP за ПК в домашней сети
1) Админка Keenetic → "Список устройств".
2) Найди свой ПК.
3) Включи "Постоянный IP" и назначь (пример) 192.168.1.50.

Шаг 2. Проверь, что сервер запущен на 0.0.0.0
Запуск должен быть таким:
   python -m uvicorn backend.main:app --host 0.0.0.0 --port 8000

Шаг 3. Настрой переадресацию порта (NAT)
1) Keenetic → "Переадресация портов" (Port Forwarding).
2) Добавить правило:
   - Протокол: TCP
   - Внешний порт: 18443   (пример)
   - Внутренний IP: 192.168.1.50
   - Внутренний порт: 8000
3) Сохранить.

Шаг 4. Проверка
- Извне (не из домашнего Wi‑Fi):
  http://ВАШ_ПУБЛИЧНЫЙ_IP:18443/

Если не работает, вероятные причины:
- У провайдера нет "белого" IP (CGNAT)
- ПК выключен / сервер не запущен
- Windows Firewall блокирует входящие

Шаг 5. DDNS (чтобы был адрес не цифрами)
Если IP меняется, можно подключить DDNS у Keenetic:
- В админке найди "Доменное имя DDNS"
- Подключи сервис (No-IP и т.п.)


====================
МИНИМУМ БЕЗОПАСНОСТИ, ЕСЛИ ОТКРЫВАЕШЬ НАРУЖУ
====================

- НЕ используй DMZ.
- Не открывай наружу лишние порты.
- Лучше VPN.
- Если нужен публичный доступ: поставь прокси с HTTPS + паролем.
